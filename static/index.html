<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Climate Vulnerability Dashboard - Hyderabad</title>
    <meta name="description" content="AI-powered climate predictions for Hyderabad/Telangana">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/styles.css?v=8">
</head>

<body>
    <header class="header">
        <h1>Climate Vulnerability Intelligence</h1>
        <span class="location">üìç Hyderabad, Telangana</span>
    </header>

    <main class="dashboard">
        <!-- Model Selection -->
        <section class="control-panel">
            <h2>Analysis Models</h2>
            <div class="model-buttons">
                <button class="model-btn active" data-model="rainfall">üåßÔ∏è Rainfall Prediction</button>
                <button class="model-btn" data-model="drought">‚òÄÔ∏è Drought Assessment</button>
                <button class="model-btn" data-model="heatwave">üî• Heatwave Risk</button>
                <button class="model-btn" data-model="tourism">üèõÔ∏è Resilient Tourism</button>
                <button class="model-btn" data-model="media">üì¢ Media Intelligence</button>
                <button class="model-btn" data-model="crop">üåæ Crop Impact Analysis</button>
                <button class="model-btn" data-model="grid">üü¶ Resilience Grid</button>
                <button class="model-btn" data-model="iot">üì° IoT Monitoring Hub</button>
                <button class="model-btn" data-model="route">üõ£Ô∏è Safe Route Finder</button>
                <button class="model-btn" data-model="agri">üë®‚Äçüåæ Farmer Advisory</button>
            </div>
        </section>

        <!-- Input Form -->
        <section class="input-section">
            <h2>Configuration Parameters</h2>

            <!-- Rainfall Form -->
            <form id="rainfall-form" class="model-form active">
                <div class="mode-toggle">
                    <button type="button" class="mode-btn active" data-mode="citizen" data-form="rainfall">Citizen Mode</button>
                    <button type="button" class="mode-btn" data-mode="expert" data-form="rainfall">Expert Mode</button>
                </div>
                <!-- CITIZEN MODE (default) -->
                <div class="citizen-inputs" id="rainfall-citizen-inputs">
                    <div class="info-box" style="background: #eff6ff; border-color: #bfdbfe; color: #1e40af;">
                        <p><strong>Smart Mode:</strong> Select a month and the AI will auto-compute prediction features from 121 years of IMD historical data.</p>
                    </div>
                    <div class="form-row">
                        <label>Which month do you want to predict rainfall for?</label>
                        <select name="smart_month">
                            <option value="1">January</option><option value="2">February</option>
                            <option value="3">March</option><option value="4">April</option>
                            <option value="5">May</option><option value="6" selected>June (Monsoon)</option>
                            <option value="7">July</option><option value="8">August</option>
                            <option value="9">September</option><option value="10">October</option>
                            <option value="11">November</option><option value="12">December</option>
                        </select>
                    </div>
                </div>
                <!-- EXPERT MODE (hidden) -->
                <div class="expert-inputs" id="rainfall-expert-inputs" style="display: none;">
                    <div class="form-row"><label>Target Month</label>
                        <select name="month"><option value="1">January</option><option value="2">February</option><option value="3">March</option><option value="4">April</option><option value="5">May</option><option value="6" selected>June</option><option value="7">July</option><option value="8">August</option><option value="9">September</option><option value="10">October</option><option value="11">November</option><option value="12">December</option></select>
                    </div>
                    <div class="form-row"><label title="Rainfall from the previous month.">Lag 1 (Prev Month Rain mm)</label><input type="number" name="lag_1" value="120" step="0.1"></div>
                    <div class="form-row"><label title="Rainfall from two months ago.">Lag 2 (2 Months Ago mm)</label><input type="number" name="lag_2" value="80" step="0.1"></div>
                    <div class="form-row"><label title="Rainfall from three months ago.">Lag 3 (3 Months Ago mm)</label><input type="number" name="lag_3" value="40" step="0.1"></div>
                    <div class="form-row"><label title="Same month last year.">Lag 12 (Same Month Last Year mm)</label><input type="number" name="lag_12" value="150" step="0.1"></div>
                </div>
                <div class="auto-features-panel" id="rainfall-auto-features" style="display: none;"><h4>What the AI computed:</h4><div class="features-grid"></div></div>
                <button type="submit" class="predict-btn">Generate Prediction</button>
                <button type="button" class="simulate-btn" data-form="rainfall">üîÑ Simulate Scenario</button>
            </form>

            <!-- Drought Form -->
            <form id="drought-form" class="model-form">
                <div class="mode-toggle">
                    <button type="button" class="mode-btn active" data-mode="citizen" data-form="drought">Citizen Mode</button>
                    <button type="button" class="mode-btn" data-mode="expert" data-form="drought">Expert Mode</button>
                </div>
                <!-- CITIZEN MODE -->
                <div class="citizen-inputs" id="drought-citizen-inputs">
                    <div class="info-box" style="background: #eff6ff; border-color: #bfdbfe; color: #1e40af;">
                        <p><strong>Smart Mode:</strong> Select a month and the AI will auto-assess drought risk from historical rainfall patterns and recent conditions.</p>
                    </div>
                    <div class="form-row">
                        <label>Which month do you want to assess drought risk for?</label>
                        <select name="smart_drought_month">
                            <option value="1">January</option><option value="2">February</option>
                            <option value="3">March</option><option value="4">April</option>
                            <option value="5" selected>May (Pre-Monsoon)</option><option value="6">June</option>
                            <option value="7">July</option><option value="8">August</option>
                            <option value="9">September</option><option value="10">October</option>
                            <option value="11">November</option><option value="12">December</option>
                        </select>
                    </div>
                </div>
                <!-- EXPERT MODE -->
                <div class="expert-inputs" id="drought-expert-inputs" style="display: none;">
                    <div class="form-row"><label title="Average rainfall over the last 3 months.">3-Month Avg Rainfall (mm)</label><input type="number" name="rolling_3mo" value="50"></div>
                    <div class="form-row"><label title="Average rainfall over the last 6 months.">6-Month Avg Rainfall (mm)</label><input type="number" name="rolling_6mo" value="60"></div>
                    <div class="form-row"><label title="Percentage deviation from long-term average.">Deficit from Normal (%)</label><input type="number" name="deficit_pct" value="30"></div>
                    <div class="form-row"><label title="Previous year drought score.">Last Year Drought Score</label><input type="number" name="prev_year_drought" value="25"></div>
                    <div class="form-row"><label title="Monsoon performance index. 1.0 is normal.">Monsoon Strength (0-2)</label><input type="number" name="monsoon_strength" step="0.1" value="0.8"></div>
                </div>
                <div class="auto-features-panel" id="drought-auto-features" style="display: none;"><h4>What the AI computed:</h4><div class="features-grid"></div></div>
                <button type="submit" class="predict-btn">Assess Drought Risk</button>
                <button type="button" class="simulate-btn" data-form="drought">üîÑ Simulate Scenario</button>
            </form>

            <!-- Heatwave Form -->
            <form id="heatwave-form" class="model-form">
                <div class="mode-toggle">
                    <button type="button" class="mode-btn active" data-mode="citizen" data-form="heatwave">Citizen Mode</button>
                    <button type="button" class="mode-btn" data-mode="expert" data-form="heatwave">Expert Mode</button>
                </div>
                <!-- CITIZEN MODE -->
                <div class="citizen-inputs" id="heatwave-citizen-inputs">
                    <div class="info-box" style="background: #eff6ff; border-color: #bfdbfe; color: #1e40af;">
                        <p><strong>Smart Mode:</strong> Select a month and the AI will auto-compute heatwave risk from recent temperature records + live humidity data.</p>
                    </div>
                    <div class="form-row">
                        <label>Which month do you want to assess heatwave risk for?</label>
                        <select name="smart_heatwave_month">
                            <option value="1">January</option><option value="2">February</option>
                            <option value="3">March</option><option value="4">April</option>
                            <option value="5" selected>May (Peak Heat)</option><option value="6">June</option>
                            <option value="7">July</option><option value="8">August</option>
                            <option value="9">September</option><option value="10">October</option>
                            <option value="11">November</option><option value="12">December</option>
                        </select>
                    </div>
                </div>
                <!-- EXPERT MODE -->
                <div class="expert-inputs" id="heatwave-expert-inputs" style="display: none;">
                    <div class="form-row"><label title="Highest recorded temperature yesterday.">Yesterday Max Temp (¬∞C)</label><input type="number" name="max_temp_lag1" step="0.1" value="42"></div>
                    <div class="form-row"><label title="Maximum temperature from two days ago.">2 Days Ago Max (¬∞C)</label><input type="number" name="max_temp_lag2" step="0.1" value="41"></div>
                    <div class="form-row"><label title="Maximum temperature from three days ago.">3 Days Ago Max (¬∞C)</label><input type="number" name="max_temp_lag3" step="0.1" value="39"></div>
                    <div class="form-row"><label title="Relative humidity. High humidity increases Heat Index.">Humidity (%)</label><input type="number" name="humidity" value="25"></div>
                    <div class="form-row"><label title="Calendar month (1-12). Heatwaves in Hyderabad peak March-June.">Month (1-12)</label><input type="number" name="month" min="1" max="12" value="5"></div>
                </div>
                <div class="auto-features-panel" id="heatwave-auto-features" style="display: none;"><h4>What the AI computed:</h4><div class="features-grid"></div></div>
                <button type="submit" class="predict-btn">Calculate Probability</button>
                <button type="button" class="simulate-btn" data-form="heatwave">üîÑ Simulate Scenario</button>
            </form>

            <!-- Crop Impact Form -->
            <form id="crop-form" class="model-form">
                <div class="mode-toggle">
                    <button type="button" class="mode-btn active" data-mode="citizen" data-form="crop">Citizen Mode</button>
                    <button type="button" class="mode-btn" data-mode="expert" data-form="crop">Expert Mode</button>
                </div>
                <!-- CITIZEN MODE -->
                <div class="citizen-inputs" id="crop-citizen-inputs">
                    <div class="info-box" style="background: #eff6ff; border-color: #bfdbfe; color: #1e40af;">
                        <p><strong>Smart Mode:</strong> Just select your crop, state, and season. The AI will auto-compute rainfall, fertilizer, and pesticide data from historical records.</p>
                    </div>
                    <div class="form-row">
                        <label>Which crop are you growing?</label>
                        <select name="smart_crop_type">
                            <option value="Rice">Rice</option>
                            <option value="Cotton(lint)">Cotton</option>
                            <option value="Maize">Maize</option>
                            <option value="Groundnut">Groundnut</option>
                            <option value="Sugarcane">Sugarcane</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <label>Your state?</label>
                        <select name="smart_state">
                            <option value="Andhra Pradesh">Andhra Pradesh</option>
                            <option value="Telangana" selected>Telangana</option>
                            <option value="Karnataka">Karnataka</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <label>Growing season?</label>
                        <select name="smart_season">
                            <option value="Kharif" selected>Kharif (Monsoon)</option>
                            <option value="Rabi">Rabi (Winter)</option>
                            <option value="Whole Year">Whole Year</option>
                        </select>
                    </div>
                </div>
                <!-- EXPERT MODE -->
                <div class="expert-inputs" id="crop-expert-inputs" style="display: none;">
                    <div class="form-row"><label>Crop Type</label>
                        <select name="crop_type"><option value="Rice">Rice</option><option value="Cotton(lint)">Cotton</option><option value="Maize">Maize</option><option value="Groundnut">Groundnut</option><option value="Sugarcane">Sugarcane</option></select>
                    </div>
                    <div class="form-row"><label>State</label>
                        <select name="state"><option value="Andhra Pradesh">Andhra Pradesh</option><option value="Telangana">Telangana</option><option value="Karnataka">Karnataka</option></select>
                    </div>
                    <div class="form-row"><label>Season</label>
                        <select name="season"><option value="Kharif">Kharif</option><option value="Rabi">Rabi</option><option value="Whole Year">Whole Year</option></select>
                    </div>
                    <div class="form-row"><label title="Total projected seasonal rainfall in mm.">Projected Rainfall (mm)</label><input type="number" name="rainfall" value="1000"></div>
                    <div class="form-row"><label title="Anticipated rainfall deviation.">Rainfall Anomaly (%)</label><input type="number" name="rainfall_anomaly" value="-10"></div>
                    <div class="form-row"><label title="Fertilizer intensity.">Fertilizer (kg/ha)</label><input type="number" name="fertilizer_per_area" value="120"></div>
                    <div class="form-row"><label title="Pesticide application rate.">Pesticide (kg/ha)</label><input type="number" name="pesticide_per_area" step="0.1" value="2.5"></div>
                </div>
                <div class="auto-features-panel" id="crop-auto-features" style="display: none;"><h4>What the AI computed:</h4><div class="features-grid"></div></div>
                <button type="submit" class="predict-btn">Predict Crop Impact</button>
                <button type="button" class="simulate-btn" data-form="crop">üîÑ Simulate Scenario</button>
            </form>

            <!-- Farmer Advisory Form -->
            <form id="agri-form" class="model-form">
                <div class="info-box" style="background: #f0fdf4; border-color: #bbf7d0;">
                    <p style="color: #166534;"><strong>AI Agri-Advisor:</strong> Aligning with India's DPI goals to
                        provide actionable climate intelligence for farmers.</p>
                </div>
                <div class="form-row">
                    <label>Current Crop</label>
                    <select name="crop">
                        <option value="Paddy">Paddy (Rice)</option>
                        <option value="Cotton">Cotton</option>
                        <option value="Sugarcane">Sugarcane</option>
                        <option value="Maize">Maize</option>
                        <option value="Millets">Millets</option>
                    </select>
                </div>
                <div class="form-row">
                    <label>Assessed Drought Probability (%)</label>
                    <input type="number" name="drought_prob" value="65" min="0" max="100">
                </div>
                <button type="submit" class="predict-btn" style="background: #16a34a;">Generate Advisory Report</button>

                <!-- NEW: Precision Satellite Scan -->
                <div
                    style="margin-top: 1.5rem; padding: 1.25rem; background: #064e3b; border-radius: 12px; border: 1px solid #065f46; color: white;">
                    <h4 style="margin-bottom: 0.5rem; color: #34d399; font-size: 0.9rem;">üõ∞Ô∏è Advanced Satellite Scanner
                    </h4>
                    <p style="font-size: 0.75rem; margin-bottom: 1rem; color: #a7f3d0;">Simulate an ISRO/Bhuvan NDVI
                        scan to identify specific stressed zones on your land.</p>
                    <button type="button" id="scan-farm-health" class="btn-primary"
                        style="width: 100%; background: #059669; border: none;">Scan Farm Health (Precision UI)</button>

                    <div id="ndvi-legend" style="margin-top: 1rem; font-size: 0.7rem; display: none;">
                        <span style="display: block; margin-bottom: 0.25rem;">Health Index (NDVI) Scale:</span>
                        <div style="display: flex; gap: 2px;">
                            <div style="flex: 1; height: 8px; background: #ef4444;" title="Critical Stress"></div>
                            <div style="flex: 1; height: 8px; background: #f97316;" title="High Stress"></div>
                            <div style="flex: 1; height: 8px; background: #facc15;" title="Moderate Risk"></div>
                            <div style="flex: 1; height: 8px; background: #22c55e;" title="Healthy"></div>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 2px;">
                            <span>Stressed</span>
                            <span>Optimal</span>
                        </div>

                        <div class="interpretation-guide"
                            style="margin-top: 1rem; padding: 0.75rem; background: #065f46; border-radius: 8px; border: 1px solid #34d39960;">
                            <h5 style="color: #34d399; margin-bottom: 0.25rem; font-size: 0.75rem;">üí° Citizen
                                Interpretation Guide</h5>
                            <p style="color: #a7f3d0; font-size: 0.65rem; line-height: 1.2;">
                                <strong>How it works:</strong> The AI combines ISRO-simulation data with your local
                                drought risk (65% in this case).<br><br>
                                <strong>Orange/Red Zones:</strong> These areas show early moisture stress. The soil is
                                drying faster here due to local terrain.<br><br>
                                <strong>Green Zones:</strong> Crops are healthy and vigorous. No urgent action needed.
                            </p>
                        </div>
                    </div>
                </div>

                <div id="agri-results-container" style="margin-top: 1.5rem; display: none;">
                    <h4
                        style="margin-bottom: 0.75rem; color: #166534; border-bottom: 2px solid #bbf7d0; padding-bottom: 0.25rem;">
                        üìù Actionable Recommendations</h4>
                    <div id="agri-cards-list" style="display: grid; gap: 1rem;">
                        <!-- Cards injected by JS -->
                    </div>

                    <h4
                        style="margin-top: 1.5rem; margin-bottom: 0.75rem; color: #166534; border-bottom: 2px solid #bbf7d0; padding-bottom: 0.25rem;">
                        üåä Agri-Flood Resilience</h4>
                    <div id="agri-flood-box"
                        style="padding: 1rem; border-radius: 8px; font-size: 0.85rem; margin-bottom: 1rem;">
                        <!-- Flood risk info injected by JS -->
                    </div>

                    <h4
                        style="margin-top: 1rem; margin-bottom: 0.75rem; color: #166534; border-bottom: 2px solid #bbf7d0; padding-bottom: 0.25rem;">
                        üöö Market Logistical Safety</h4>
                    <div id="agri-logistics-box" style="padding: 1rem; border-radius: 8px; font-size: 0.85rem;">
                        <!-- Logistics info injected by JS -->
                    </div>
                </div>
            </form>

            <!-- Resilience Grid Form -->
            <form id="grid-form" class="model-form">
                <div class="info-box">
                    <p>The <strong>Resilience Grid</strong> calculates flood vulnerability for 500m x 500m cells across
                        central Hyderabad based on drainage proximity and historical hotspots.</p>
                </div>
                <!-- Live Weather Summary -->
                <div id="live-weather-box" class="weather-info-box" style="display:none;">
                    <h4>üìç Live Nowcasting</h4>
                    <p id="weather-text">Fetching live rainfall data...</p>
                </div>
                <button type="submit" class="predict-btn">üöÄ Load Resilience Grid Map</button>

                <!-- NEW: Urban Precision Scanner -->
                <div
                    style="margin-top: 1.5rem; padding: 1rem; background: #1e3a8a; border-radius: 12px; border: 1px solid #1e40af; color: white;">
                    <h4 style="margin-bottom: 0.5rem; color: #93c5fd; font-size: 0.9rem;">üõ∞Ô∏è Locality Precision Scanner
                    </h4>
                    <p style="font-size: 0.75rem; margin-bottom: 1rem; color: #bfdbfe;">Run a high-resolution
                        neighborhood scan (2km) for ground-level water logging & heat island risk.</p>
                    <button type="button" id="scan-urban-health" class="btn-primary"
                        style="width: 100%; background: #2563eb; border: none;">Scan Local Neighborhood</button>
                </div>

                <div id="urban-results-container"
                    style="margin-top: 1rem; display: none; padding: 1rem; background: #f8fafc; border-radius: 8px; border: 1px solid #e2e8f0; color: #1e293b;">
                    <h5
                        style="margin-bottom: 0.5rem; font-size: 0.85rem; border-bottom: 1px solid #cbd5e1; padding-bottom: 0.25rem;">
                        üìä Neighborhood Insights</h5>
                    <div id="urban-insights-content" style="font-size: 0.75rem; line-height: 1.4;">
                        <!-- Injected by JS -->
                    </div>
                </div>

                <button type="button" class="scroll-to-map btn-secondary" style="width:100%; margin-top:1rem;">üó∫Ô∏è
                    Scroll to Map</button>
            </form>

            <!-- Safe Route Form -->
            <form id="route-form" class="model-form">
                <div class="info-box">
                    <p>Select your <strong>Start</strong> and <strong>Destination</strong> by clicking on the map. The
                        AI will calculate a path that avoids high-risk flood zones.</p>
                </div>
                <div class="form-row">
                    <label>Start Point:</label>
                    <input type="text" id="route-start" placeholder="Click map to set start" readonly>
                </div>
                <div class="form-row">
                    <label>Destination:</label>
                    <input type="text" id="route-end" placeholder="Click map to set end" readonly>
                </div>
                <button type="submit" class="predict-btn">üìç Find Safest Path</button>

                <!-- NEW: Emergency Shortcut -->
                <div
                    style="margin-top: 1rem; padding: 1rem; background: #fff5f5; border-radius: 8px; border: 1px solid #feb2b2;">
                    <h4 style="margin-bottom: 0.5rem; color: #c53030; font-size: 0.9rem;">üÜò Emergency Safe Haven</h4>
                    <p style="font-size: 0.75rem; margin-bottom: 0.75rem; color: #742a2a;">Need immediate shelter? Click
                        below to find the nearest relief center.</p>
                    <button type="button" id="find-safe-haven" class="btn-secondary"
                        style="width: 100%; border-color: #c53030; color: #c53030;">Find Nearest Safe Haven</button>
                </div>

                <button type="button" class="scroll-to-map btn-secondary" style="width:100%; margin-top:1rem;">üó∫Ô∏è
                    Scroll to Map</button>
            </form>

            <!-- Emergency Contacts Panel -->
            <div class="crisis-contacts"
                style="margin-top: 1.5rem; padding: 1.25rem; background: #1a202c; color: white; border-radius: 12px;">
                <h3 style="color: #feb2b2; font-size: 1.1rem; margin-bottom: 1rem;">üì¢ Emergency Hotlines</h3>
                <div style="display: grid; gap: 0.75rem;">
                    <div
                        style="display: flex; justify-content: space-between; border-bottom: 1px solid #4a5568; padding-bottom: 0.5rem;">
                        <span style="font-size: 0.85rem;">GHMC Control</span>
                        <span style="font-weight: bold; color: #fbd38d;">040-21111111</span>
                    </div>
                    <div
                        style="display: flex; justify-content: space-between; border-bottom: 1px solid #4a5568; padding-bottom: 0.5rem;">
                        <span style="font-size: 0.85rem;">NDRF Hyderabad</span>
                        <span style="font-weight: bold; color: #fbd38d;">9701019909</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="font-size: 0.85rem;">Fire & Rescue</span>
                        <span style="font-weight: bold; color: #fbd38d;">101</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quick Stats -->
        <section class="stats-section">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">üåßÔ∏è Rainfall</div>
                    <div class="stat-value" id="stat-rainfall">--</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">‚òÄÔ∏è Drought Score</div>
                    <div class="stat-value" id="stat-drought">--</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">üî• Heatwave</div>
                    <div class="stat-value" id="stat-heatwave">--</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">üåæ Crop Impact</div>
                    <div class="stat-value" id="stat-crop">--</div>
                </div>
            </div>
        </section>

        <!-- Impact Showcase - Real AI Benefits -->
        <section class="impact-showcase" id="impact-showcase">
            <h2>Resilience Impact Showcase</h2>
            <p class="showcase-subtitle">Real-time scenarios powered by the same AI models you can use below</p>
            <div class="impact-cards" id="impact-cards">
                <div class="impact-loading">Loading impact scenarios...</div>
            </div>
            <div class="showcase-footer">
                <span class="data-badge" id="showcase-data-sources"></span>
            </div>
        </section>

        <!-- Historical Trend Chart -->
        <section class="chart-section">
            <h2>Historical Rainfall Trends</h2>
            <div style="position: relative; height: 320px; width: 100%;">
                <canvas id="rainfall-trend-chart"></canvas>
            </div>
        </section>

        <!-- Results -->
        <section class="results-section">
            <h2>Analysis Results</h2>
            <div id="result-card" class="result-card">
                <!-- IoT Sensor Monitoring Panel -->
                <div id="iot-panel" class="model-form">
                    <div style="background: #f8fafc; padding: 1.25rem; border-radius: 8px; border: 1px solid #e2e8f0;">
                        <h3
                            style="margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem; color: #1e293b;">
                            üì° Live Node Network (Hyderabad)
                            <span id="iot-refresh-indicator"
                                style="font-size: 0.7rem; font-weight: normal; color: #64748b; background: #f1f5f9; padding: 2px 8px; border-radius: 12px;">Waiting...</span>
                        </h3>
                        <div id="iot-sensor-grid"
                            style="display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 0.75rem; margin-bottom: 1rem;">
                            <!-- Dynamic Sensor Cards Load Here -->
                        </div>
                        <button id="refresh-iot" class="predict-btn"
                            style="background: #1e293b; width: auto; padding: 0.75rem 1.5rem;">
                            üîÑ Refresh Live Nodes
                        </button>
                    </div>
                </div>

                <!-- Tourism Safety Panel -->
                <div id="tourism-panel" class="model-form">
                    <div
                        style="background: #fff; padding: 1.25rem; border-radius: 12px; border: 1px solid #e2e8f0; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);">
                        <h3
                            style="margin-bottom: 0.5rem; color: #1e293b; display: flex; align-items: center; gap: 0.5rem;">
                            üèõÔ∏è Tourist Safety Guide (AI)
                        </h3>
                        <div id="tourism-weather-context"
                            style="margin-bottom: 1rem; padding: 0.5rem; background: #eff6ff; border-radius: 6px; font-size: 0.75rem; color: #1e40af; border: 1px solid #bfdbfe;">
                            üå¶Ô∏è <b>Live Weather Sync:</b> Fetching station data...
                        </div>
                        <div id="tourism-landmark-list" style="display: flex; flex-direction: column; gap: 0.75rem;">
                            <!-- Landmarks Load Here -->
                        </div>
                    </div>
                </div>

                <!-- Data Integrity & Audit Panel (NEW) -->
                <div
                    style="margin-top: 2rem; padding: 1rem; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 12px;">
                    <h4
                        style="font-size: 0.85rem; color: #64748b; margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.4rem;">
                        üìã Data Source Audit (Centre of Excellence Disclosure)
                    </h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; font-size: 0.7rem;">
                        <div style="padding: 0.5rem; background: white; border-radius: 6px; border: 1px solid #e2e8f0;">
                            <b style="color: #16a34a;">üü¢ REAL-TIME SOURCES</b>
                            <ul style="margin-top: 0.25rem; padding-left: 1rem;">
                                <li>Precipitation: Open-Meteo API</li>
                                <li>Air Quality: Open-Meteo AQI</li>
                                <li>GIS Mapping: OSM / Google</li>
                                <li>Drainage: Native KML Overlays</li>
                            </ul>
                        </div>
                        <div style="padding: 0.5rem; background: white; border-radius: 6px; border: 1px solid #e2e8f0;">
                            <b style="color: #2563eb;">üîµ ARCHITECTURAL SIMS</b>
                            <ul style="margin-top: 0.25rem; padding-left: 1rem;">
                                <li>IoT Hub: Virtual Ward Nodes</li>
                                <li>Crop Scan: Spectral Simulation</li>
                                <li>Media: AI-Brief Synthesis</li>
                                <li>Forecast: Random Forest Logic</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Media Intelligence Panel -->
                <div id="media-panel" class="model-form">
                    <div
                        style="background: #1e293b; color: white; padding: 1.25rem; border-radius: 12px; border: 1px solid #334155; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);">
                        <h3
                            style="margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem; color: #38bdf8;">
                            üì¢ Newsroom Alert Generator (PSA)
                        </h3>
                        <div id="media-alert-content" style="display: flex; flex-direction: column; gap: 1rem;">
                            <div
                                style="background: #0f172a; padding: 0.75rem; border-radius: 6px; border: 1px dashed #38bdf8;">
                                <small
                                    style="color: #38bdf8; text-transform: uppercase; font-size: 0.6rem; letter-spacing: 0.1em;">LIVE
                                    TICKER TAPE</small>
                                <div id="media-ticker"
                                    style="font-family: 'Courier New', monospace; color: #f8fafc; font-size: 0.9rem; margin-top: 0.25rem;">
                                    --</div>
                            </div>
                            <div style="background: #334155; padding: 0.75rem; border-radius: 6px;">
                                <small style="color: #94a3b8; text-transform: uppercase; font-size: 0.6rem;">SOCIAL
                                    BROADCAST BRIEF</small>
                                <div id="media-social"
                                    style="font-size: 0.85rem; margin-top: 0.25rem; line-height: 1.5;">--</div>
                            </div>
                            <div style="background: #0ea5e9; padding: 0.75rem; border-radius: 6px; color: white;">
                                <small style="text-transform: uppercase; font-size: 0.6rem; font-weight: 700;">ü§ù
                                    COMMUNITY ACTION</small>
                                <div id="media-action"
                                    style="font-size: 0.85rem; font-weight: 500; margin-top: 0.25rem;">--</div>
                            </div>
                        </div>
                        <button id="generate-psa" class="predict-btn"
                            style="background: #38bdf8; color: #0f172a; border: none; margin-top: 1rem; font-weight: 700;">
                            ‚ú® SYNTHESIZE NEW PSA
                        </button>
                    </div>
                </div>

                <div class="result-value" id="result-value">--</div>
                <div class="result-status" id="result-status">Ready for Analysis</div>
                <div class="result-details" id="result-details">Select a model to begin</div>
            </div>

            <!-- Path Details Panel -->
            <div id="route-details-panel" class="route-details" style="display: none;">
                <h3>Safe Route Breakdown</h3>
                <div id="route-summary-stats" class="route-stats"></div>
                <ul id="route-steps-list"></ul>
            </div>
        </section>

        <!-- Map Section -->
        <section class="map-section">
            <h2>Geospatial Intelligence</h2>
            <div class="map-controls">
                <select id="kml-select">
                    <option value="">Select Region Overlay</option>
                </select>
                <button id="load-kml" class="btn-secondary">Load Layer</button>

                <!-- New Resilience Controls -->
                <div class="resilience-addon">
                    <label for="opacity-slider">Grid Opacity:</label>
                    <input type="range" id="opacity-slider" min="0" max="100" value="60">
                </div>
                <button id="report-flooding" class="btn-secondary danger-btn">‚ö†Ô∏è Report Active Flooding</button>
            </div>
            <div id="map"></div>
        </section>
    </main>

    <footer class="footer">
        <p>Climate Vulnerability Intelligence ‚Ä¢ v2.0 Enterprise Edition</p>
        <p><a href="/docs" target="_blank">API Documentation</a></p>
    </footer>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet-omnivore@0.3.4/leaflet-omnivore.min.js"></script>
    <script src="/static/app.js?v=8"></script>
</body>

</html>